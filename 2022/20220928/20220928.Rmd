---
title: "Reasoning about Interventions: A Statistical Tour"
output:
  xaringan::moon_reader:
    css: ["default", "css/xaringan-themer.css"]
    lib_dir: libs
    self_contained: false
    nature:
      highlightStyle: github
      highlightLines: true
      ratio: "16:9"
    seal: false
---

```{r, echo = FALSE, warnings = FALSE, message = FALSE}
library(knitr)
library(RefManageR)
opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, cache = T, dpi = 200, fig.align = "center", fig.width = 6, fig.height = 3)
bib <- ReadBib("references.bib", check = FALSE)
BibOptions(cite.style = "numeric")
```

.center[
# Reasoning about Interventions: <br> A Statistical Tour
<img src="figures/hypothetical_curve.svg" width = 600/>
### Wisconsin Institute for Discovery Seminar
.large[Kris Sankaran | [krisrs1128.github.io/LSLab](krisrs1128.github.io/LSLab) | 28 September 2021]
]

---

### Reflection

1. It is one thing to *understand* robustness / resilience / adaptability in a system.

2. It is another thing to *engineer* these properties into a system.

3. In general, both problems can be complex, but for different reasons. I’ll share some statistical ideas that can help.

---

### Why do we make mathematical models?


```{r, echo = FALSE, eval = FALSE}
set.seed(123)
library(tidyverse)
theme_set(theme_minimal())
n <- 200
df <- tibble(x = rnorm(n)) %>%
  mutate(y = .8 * x + rnorm(n, 0, 0.2))
ggplot(df) +
  geom_vline(xintercept = 0, color = "#d3d3d3", size = 1) +
  geom_hline(yintercept = 0, color = "#d3d3d3", size = 1) +
  geom_point(aes(x, y), size = 0.8) +
  coord_fixed() +
  theme(panel.grid.minor = element_blank())
ggsave("figures/motivation_base.svg", width = 5, height = 5)

ggplot(df) +
  geom_vline(xintercept = 0, color = "#d3d3d3", size = 1) +
  geom_hline(yintercept = 0, color = "#d3d3d3", size = 1) +
  geom_point(aes(x, y), size = 0.8, col = "#e5e5e5") +
  coord_fixed() +
  theme(panel.grid.minor = element_blank()) +
  stat_smooth(
    aes(x, y), 
    method = "lm",
    se = FALSE,
    col = "#D9674E"
  )
ggsave("figures/motivation_distillation.svg", width = 5, height = 5)
```


1. Distillation: A few parameters in a model can reduce a large dataset to its essence. It is like data compression for humans.
2. Manipulation: A good model helps us make predictions about the consequences of specific interventions. It can help us plan for the future.

Both activities are central to the process of discovery.

.center[
<img src="figures/motivation_combined.svg" width=850/>
]

---

## Vignette 1: Antibiotics and the Microbiome

---

### Context and Data

1. In `r Citep(bib, "sankaran2019latent")`, we reanalyzed data from 
`r Citep(bib, "dethlefsen2011incomplete")`, which took longitudinal species count
from 3 subjects (52 - 56 timepoints)

1. We drew inspiration from our collaborator's ecological metaphors for
microbiome perturbations (antibiotics $\approx$ a flash flood or wildfire)

.center[
<img src="figures/adaptive-landscape-scenario-1.svg" width=720/>
]

---

### Context and Data

1. In `r Citep(bib, "sankaran2019latent")`, we reanalyzed data from 
`r Citep(bib, "dethlefsen2011incomplete")`, which took longitudinal species count
from 3 subjects (52 - 56 timepoints)

1. We drew inspiration from our collaborator's ecological metaphors for
microbiome perturbations (antibiotics $\approx$ a flash flood or wildfire)

.center[
<img src="figures/adaptive-landscape-scenario-2.svg" width=700/>
]

---

### Initial Visualization

It was helpful to explore the raw data, and we built a small interactive
visualization package to help query which species were and were not strongly
influenced by the perturbations.

<iframe src="https://krisrs1128.github.io/treelapse/pages/antibiotic.html"/ width=800 height = 300>

---

### Topic Models

* We were inspired by an analogy between text and microbiome data `r Citep(bib, "schloss2007last", .opts = list(cite.style = "numeric"))`
* Samples are like documents, and taxa are like words.
* We took models for summarizing evolving themes across text corpora and applied them to the microbiome

.center[
<img src="figures/neuroscience.png" width=800/>
]

---

### Topic Models

* We were inspired by an analogy between text and microbiome data `r Citep(bib, "schloss2007last")`
* Samples are like documents, and taxa are like words.
* We took models for summarizing evolving themes across text corpora and applied them to the microbiome

.center[
<img src="figures/antibiotics_topics.png" width=650/>
]

---

### Topic Models

This helped reduce the full community data into a few “themes,”

* Vulnerable taxa: Those knocked out the full duration of the perturbation
* Resilient taxa: Those that recover even while perturbations are ongoing
* Robust taxa: Seem to thrive when other community members disappear

.center[
<img src="figures/perturbation_topics.png" width=590 />
]

---

### Aside: Box and Tiao 1975

.pull-left[
1. I would be curious to see whether we can improve sensitivity by incorporating intervention information
2. One of my favorite models for this is the transfer function model `r Citep(bib, "box1975intervention")`. It was motivated by a study of the effects of environmental legislation on air pollution in LA. 
]

.pull-right[
<img src="figures/box_tiao.png"/ width=650>
]

---

## Vignette 2: Meditation and the Microbiome

---

### Hypothetical Reasoning

1. Data alone are not enough — it is valuable to reason hypothetically
1. We design experiments so that we can make effective predictions about the consequences of potential actions
1. We need to switch from the compression to the manipulation perspective

.center[
<img src="figures/hypothetical_curve.svg" width=700/>
]

---

### Context and Data

For concreteness, consider an ongoing study of mindfulness interventions from the Center for Healthy Minds.

.pull-left[
1. Half of participants have been randomly assigned to a mindfulness intervention group
2. We will track participants over three timepoints, with a mindfulness intervention just before the second
]

.pull-right[
<img src="figures/design.svg" width=500/>
]

---

### Psychometric & Genomic Integration

1. We are gathering psychometric, behavioral, chemical, and microbiome compositional data
2. Changes in one might be associated with effects across all — how can we reason about the possibilities?

<img src="figures/integration.svg"/>

---

### Graphical Modeling

1. Generative graphical models provide a language for clarifying the dependence
relationships across measurements
2. Linked variables are dependent, even after controlling the influence from all
others

.center[
<img src="figures/dags.png" width = 550/>
]

---

### A Grammar for Modeling

.pull-left[
Different graphical structures can be composed with one another to express complex hypothesized structures.

Mediation Model: Does meditation change diet, which changes the microbiome?
]

.pull-right[
<img src="figures/mediation-dag.svg" width=500/>
]

---

### A Grammar for Modeling

.pull-left[
Different graphical structures can be composed with one another to express complex hypothesized structures.
]

.pull-right[
Heterogeneous Effect Model: Do people who respond strongly to meditation have a particular microbiome profile?
]

---

### Interventions and Counterfactuals

1. Graphical models allow us to “intervene” on specific variables and evaluate their downstream effects
2. By positing a specific model structure, we can estimate quantities related to these counterfactuals
	1. E.g., we can compute counterfactual direct vs. indirect effects

---

### Semisynthetic Simulation

1. These models will learn relationships between each linked variable. How can we gauge the quality of these estimates?
2. One idea is to simulate semisynthetic data. These are data that respect the assumed graphical structure, but whose distributions are drawn from the real data
3. It offers a compromise between completely synthetic data (which may be unrealistic) and actually real data (for which we don’t have a ground truth).

---

### Semisynthetic Power Analysis

This is an example power analysis done with semisynthetic from the meditation
study shown above. We simulated new data using a collection of quantile
regressions to real data.

---

### Takeaways

1. The most powerful models are those that promote scientific thinking,
	1. Compression: Remove noise to reveal essential structure.
	1. Manipulation: Allow us to reason flexibly about alternatives.
1. Reasoning about the generative mechanism is key for integrative
analysis
  1. Graphical models can support modeling and evaluation

---

## References

```{r, results='asis', echo=FALSE}
PrintBibliography(bib)
```
