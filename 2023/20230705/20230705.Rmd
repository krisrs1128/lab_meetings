---
title: "20230705"
output:
  xaringan::moon_reader:
    css: ["default", "css/xaringan-themer.css"]
    lib_dir: libs
    self_contained: false
    fig_caption: true
    nature:
      highlightStyle: github
      highlightLines: true
      ratio: "16:9"
    seal: false
---

class: title
image-opacity: 0.1
background-image: url("figures/cover.png")
background-size: cover

```{r, echo = FALSE, warnings = FALSE, message = FALSE}
library(RefManageR)
library(knitr)
library(tidyverse)
opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, cache = TRUE, dpi = 200, fig.align = "center", fig.width = 6, fig.height = 3, eval = TRUE)
opts_knit$set(eval.after = "fig.cap")

BibOptions(cite.style = "numeric")
bib <- ReadBib("references.bib")
```

.center[
<br/>
# Ecosystem Modeling using Multimodal Data
<br/>
<br/>
<br/>
<br/>
]

#### Microsoft AI for Social Good Lab

.large[
Kris Sankaran <br/>
05 | July | 2023 <br/>
https://github.io/krisrs1128/LSLab
<br/>
]

---

### Introduction

These themes have recurred across almost all the projects I have encountered in
my research:

* **Multimodality**: Data are gathered from complementary sensors or assays
* **Ecosystem Analysis**: We would like to understand the interactions in a landscape that are difficult to observe except through data.

---

### Motivating Challenges

.pull-left[
* Glacier monitoring in the Hindu Kush Himalayas
* Designing treatments for Bacterial Vaginosis
* Understanding the role of the gut-brain axis in mental health
* Reducing climate change misinformation by understanding its spread
]

.pull-right[
Problem | Ecosystem | Data |
--|--|--
Glacier Monitoring | Himalayas | Remote Sensing
Bacterial Vaginosis | Host-Microbiome | Meta-Omics
Gut-Brain Axis | Host-Microbiome | Meta-Omics
Climate Misinformation | Social Media | Web Data
]

---

### Motivating Challenges

.pull-left[
* **Glacier monitoring in the Hindu Kush Himalayas**
* **Designing treatments for Bacterial Vaginosis**
* Understanding the role of the gut-brain axis in mental health
* Reducing climate change misinformation by understanding its spread
]

.pull-right[
Problem | Ecosystem | Data |
--|--|--
Glacier Monitoring | Himalayas | Remote Sensing
Bacterial Vaginosis | Host-Microbiome | Meta-Omics
Gut-Brain Axis | Host-Microbiome | Meta-Omics
Climate Misinformation | Social Media | Web Data
]


---
background-color: #f7f7f7
background-image: url("figure/multimodal-glaciers-cover.png")
background-size: contain

.center[
## Multimodality in Earth Observation
]



---

### Glacier Monitoring

* This work has grown from a collaboration with ICIMOD
* Glaciers provide significant ecosystem resources, and their disappearance has a large impact on the communities around them
* Effective remote sensing data analysis could help generate maps over large areas much faster than human annotation could

---

### Glacier Monitoring

Semantic segmentation models can be trained to distinguish different types of
glaciers and estimate glacial lake areas `r Citep(bib, c("Baraka2020MachineLF", "Zheng2021InteractiveVA", "Ortiz2022MappingGL"))`

.pull-left[
<img src="figure/glacier_lakes_trends.png"/>
<img src="figure/glacier_lakes_volcano.png" width=250/>
]
.pull-right[
<img src="figure/glacier_lakes_errors.png"/>
]
 
[Colab Notebook](https://colab.research.google.com/drive/1ZkDtLB_2oQpSFDejKZ4YQ5MXW4c531R6?usp=sharing#scrollTo=r9jkq9qYcX_-)

---

### Multimodal Data

* There is a trade-off between spatial and spectral resolution when working with data from different satellite sensors.
* A second wrinkle is that sources are ever-changing. If we would like to map change over long periods, it is necessary to integrate across them.
* Though we have not explored this, it would be possible to integrate ground-level ecosystem data, like species counts from wildlife monitoring apps

(Figure of )

---

### An Experiment

* How robust is multimodal segmentation to modality missingness?
* Can we train models in contexts where all sources are available and then directly apply them to settings where some are not?

(Figure of Transformers)

Yuliang Peng led this project.

---

### Study Design

We studied Segformer models [Ref3] with early, middle, and late fusion.

---

### Results

---

### Opportunities

The dream would be to build models that automatically get better as new sources
become available.

---

.center[
## Multimodality in Microbiome Studies
]

---

### Bacterial Vaginosis

.pull-left[
* Bacterial Vaginosis (BV) affects 20% of women worldwide, with elevated rates in Sub-Saharan Africa. It is a known risk factor for preterm birth and HIV transmission.
* BV is a disease of imbalanc -- it doesn't come from a pathogen, but rather interactions across the microbial community / host immune system
]

.pull-right[
<img src="figure/bv_overview.jpg" width=500/>
Figure from `r Citep(bib, "Mitchell2014BacterialVA")`.
]

---

### Bacterial Vaginosis

* Several initiatives, including the Gates Foundation-funded Vaginal Microbiome Research Consortium, are gathering multimodal molecular ("multi-omics") profiles to clarify the mechanisms behind disease development and recurrence
* The goal is to use these multi-omics profiles to design precision treatments.
  * E.g., new probiotics, vaginal fluid/microbiome transplants
  

---

### Multimodal Data

Different molecular assays are needed to capture different aspects of both the
microbiome and the host immunological environment. 

* Results in multiple tables of data, each potentially high-dimensional
* Typically gather data over time (but not necessarily on the same samples)

---

### Multimodal Data

* Human Host
  - Single Cell RNA-seq: How are genes from different host cell types expressed?
  - Cytokine Assays: Which immune system cells are present?
  - Survey Data: What host behaviors may influence disease trajectory?
* Microbiome
  - 16S rRNA sequence: What are the bacterial species abundances?
  - Metagenomic Sequencing: What functions can those bacteria potentially carry out?
  - Metatranscriptomic Sequencing: Which genes are expressed?
* Either
  - Metabolomics: What small molecules are present?

---

### Integrated Learning

To help study BV, we have prepared code to support the entire analysis and
interpretation workflow.

* Experimental design and power analysis.
* Normalization, batch effect correction, missing data imputation.
* Disease state/trajectory prediction.
* Interpretation and visualization.

Aside: Simple concatenation usually works poorly because some modalities drown out
others `r Citep(bib, c("Baker2019FeatureSF", "Ding2021CooperativeLF"))`

<!-- * Supervised methods balance features from across sources to predict sample-level -->
<!-- outcomes, like subsequent disease development -->
<!-- * Unsupervised methods create sample or feature-level "maps" that guide overall dataset interpretation -->
<!-- * Network methods learn links between features across modalities -->

---

### Analysis: Topic Alignment

* It is natural to apply topic models to omics data (samples -> documents, words -> molecules)
* We studied approaches to visualize an ensemble of topic models, using the results to study multiscale and multimodal relationships
.pull-left[
<img src="https://lasy.github.io/alto/articles/microbiome-demo_files/figure-html/plot-with-add-leaves-and-id-numbers-1.png" width=450/>
]
.pull-right[
<img src="https://lasy.github.io/alto/articles/microbiome-demo_files/figure-html/beta-plot-2.png" width=450/>
]

[Multiscale analysis of count data through topic alignment](https://doi.org/10.1093/biostatistics/kxac018)

---

### Analysis: Intervention Analysis

What would longitudinal trajectories be like with or without specific
interventions? We adapted ideas from the transfer function methodology.

.center[
<img src="https://krisrs1128.github.io/mbtransfer/articles/postpartum_files/figure-html/unnamed-chunk-15-1.png"/>
]

[Microbiome Intervention Analysis with Transfer Functions and Mirror Statistics](https://arxiv.org/abs/2306.06364)

---

### Reusability and Open Science

It has been rewarding to work with computational biologists who generate and
analyze the BV data.

* We can focus our energy on the development of rigorous data analysis methods
* The collaboration results in modular, reusable packages and publicly accessible notebooks

---

.center[
## Closing Thoughts
]

---

### Mount Chiborazo

This is one of my favorite visualizations from the history of science.

.center[
<img width=950 src="figure/Geographie_der_Pflanzen_in_den_Tropen-Ländern.jpg"/>
]

---

### Mount Chiborazo

It is Alexander von Humboldt's *Tableau Physique*, and it shows how multiple data
sources can be combined to create a unified view of the world^[It is also remarkable how it anticipates many ideas from functional genomics.].

.center[
<img width=820 src="figure/Geographie_der_Pflanzen_in_den_Tropen-Ländern.jpg"/>
]

---

### Interdependence

At a time when most science focused on taxonomy, the *Tableau* highlighted interdependence and unity within nature.

.center[
<img width=820 src="figure/Geographie_der_Pflanzen_in_den_Tropen-Ländern.jpg"/>
]

---

### References

```{r, results='asis', echo = FALSE}
PrintBibliography(bib, start = 1, end = 4)
```
